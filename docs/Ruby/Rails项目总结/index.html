<!doctype html>
<html lang="zh" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-Ruby/Rails项目总结">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Rails 项目总结 | GSemir</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://gsemir0418.github.io/blog-docusaurus-preview/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://gsemir0418.github.io/blog-docusaurus-preview/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://gsemir0418.github.io/blog-docusaurus-preview/docs/Ruby/Rails项目总结"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Rails 项目总结 | GSemir"><meta data-rh="true" name="description" content="环境配置"><meta data-rh="true" property="og:description" content="环境配置"><link data-rh="true" rel="icon" href="/blog-docusaurus-preview/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://gsemir0418.github.io/blog-docusaurus-preview/docs/Ruby/Rails项目总结"><link data-rh="true" rel="alternate" href="https://gsemir0418.github.io/blog-docusaurus-preview/docs/Ruby/Rails项目总结" hreflang="zh"><link data-rh="true" rel="alternate" href="https://gsemir0418.github.io/blog-docusaurus-preview/docs/Ruby/Rails项目总结" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog-docusaurus-preview/blog/rss.xml" title="GSemir RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog-docusaurus-preview/blog/atom.xml" title="GSemir Atom Feed"><link rel="stylesheet" href="/blog-docusaurus-preview/assets/css/styles.d8a9c43f.css">
<link rel="preload" href="/blog-docusaurus-preview/assets/js/runtime~main.4b3a6e80.js" as="script">
<link rel="preload" href="/blog-docusaurus-preview/assets/js/main.ce3b1955.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/blog-docusaurus-preview/"><div class="navbar__logo"><img src="/blog-docusaurus-preview/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/blog-docusaurus-preview/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Gsemir</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog-docusaurus-preview/docs/intro">Blog</a><a class="navbar__item navbar__link" href="/blog-docusaurus-preview/projects-page">个人项目</a><a class="navbar__item navbar__link" href="/blog-docusaurus-preview/blog">每日X问</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/GSemir0418" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/blog-docusaurus-preview/"><img src="/blog-docusaurus-preview/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/blog-docusaurus-preview/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"><b>Gsemir</b></a><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/blog-docusaurus-preview/docs/intro">Tutorial Intro</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/blog-docusaurus-preview/docs/category/tutorial---basics">Tutorial - Basics</a><button aria-label="打开/收起侧边栏菜单「Tutorial - Basics」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/blog-docusaurus-preview/docs/category/ruby">Ruby</a><button aria-label="打开/收起侧边栏菜单「Ruby」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/blog-docusaurus-preview/docs/Ruby/Rails项目总结">Rails 项目总结</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/blog-docusaurus-preview/docs/category/tutorial---extras">Tutorial - Extras</a><button aria-label="打开/收起侧边栏菜单「Tutorial - Extras」" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/blog-docusaurus-preview/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/blog-docusaurus-preview/docs/category/ruby"><span itemprop="name">Ruby</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Rails 项目总结</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><h1>初始化</h1><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="环境配置">环境配置<a href="#环境配置" class="hash-link" aria-label="环境配置的直接链接" title="环境配置的直接链接">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="macos">macos<a href="#macos" class="hash-link" aria-label="macos的直接链接" title="macos的直接链接">​</a></h3><ol><li><p>安装 rails </p></li><li><p>安装数据库</p></li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ brew update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ brew </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> postgresql@14</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ brew services start postgresql@14</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ brew services stop postgresql@14</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="3"><li>安装必要驱动：<code>pacman -S postgresql-libs</code></li></ol><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ubuntuwsl">ubuntu(wsl)<a href="#ubuntuwsl" class="hash-link" aria-label="ubuntu(wsl)的直接链接" title="ubuntu(wsl)的直接链接">​</a></h3><ol><li><p>安装 rvm <a href="https://github.com/rvm/ubuntu_rvm" target="_blank" rel="noopener noreferrer">rvm/ubuntu_rvm: Ubuntu package for RVM (github.com)</a></p></li><li><p>安装 postgresql <a href="https://www.postgresql.org/download/linux/ubuntu/" target="_blank" rel="noopener noreferrer">PostgreSQL: Linux downloads (Ubuntu)</a></p></li></ol><ol start="3"><li>安装必要驱动：<code>sudo apt-get install libpq-dev</code></li></ol><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="数据库配置">数据库配置<a href="#数据库配置" class="hash-link" aria-label="数据库配置的直接链接" title="数据库配置的直接链接">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="macos-1">macos<a href="#macos-1" class="hash-link" aria-label="macos的直接链接" title="macos的直接链接">​</a></h3><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 连接postgresql，不指定用户名和数据库默认是当前登陆系统账号同名的用户与数据库</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">psql</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#  终端执行命令，其作用是创建一个与当前系统登陆用户同名的数据库，目的是为了可以通过这个数据库连接上 postgresql，不执行的话会报错数据库找不到</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">createdb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">psql -U USERNAME -W PASSWORD </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 创建 gsemir 用户</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CREATE </span><span class="token environment constant" style="color:#36acaa">USER</span><span class="token plain"> gsemir WITH PASSWORD </span><span class="token string" style="color:#e3116c">&#x27;123456&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 删除默认的 postgres 数据库</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DROP DATABASE postgres</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 创建属于 gsemir 用户的数据库</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CREATE DATABASE gsemir OWNER gsemir</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 将所有权限赋给 gsemir 用户</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GRANT ALL PRIVILEGES ON DATABASE gsemir to gsemir</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 给 postgres 用户添加 创建数据库 的属性</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ALTER ROLE gsemir CREATEDB</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 之后就可以使用 gsemir 用户来创建并管理其他数据库了</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ubuntuwsl-1">ubuntu(wsl)<a href="#ubuntuwsl-1" class="hash-link" aria-label="ubuntu(wsl)的直接链接" title="ubuntu(wsl)的直接链接">​</a></h3><ul><li><p>配置同上</p></li><li><p>注意事项</p><ul><li>项目代码用户与数据库用户需要统一</li><li>本项目代码的权限是属于 gsemir 用户，而数据库配置的用户只有 postgres</li><li>不能使用 gsemir 用户操作 postgres 角色（database.yml）的数据库（运行db create等）</li><li>因此 gsemir 用户也要在数据库创建<strong>同名的角色</strong>及<strong>同名的数据库</strong>，添加 createdb 权限</li></ul></li><li><p>启动服务</p><ul><li>启动 <code>sudo service postgresql start</code></li><li>状态 <code>sudo service postgresql status</code></li></ul></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="docker">docker<a href="#docker" class="hash-link" aria-label="docker的直接链接" title="docker的直接链接">​</a></h3><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> run -d </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 容器名称</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --name db-for-rails-todo </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 环境变量</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -e </span><span class="token assign-left variable" style="color:#36acaa">POSTGRES_USER</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">gsemir </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -e </span><span class="token assign-left variable" style="color:#36acaa">POSTGRES_PASSWORD</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">123456</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -e </span><span class="token assign-left variable" style="color:#36acaa">POSTGRES_DB</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">rails-todo-dev </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -e </span><span class="token assign-left variable" style="color:#36acaa">PGDATA</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">/var/lib/postgresql/data/pgdata </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 新增数据卷</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -v rails-todo-data:/var/lib/postgresql/data </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 镜像名称 版本14</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    postgres:14</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 供复制：</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> run -d --name db-for-rails-todo -e </span><span class="token assign-left variable" style="color:#36acaa">POSTGRES_USER</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">gsemir -e </span><span class="token assign-left variable" style="color:#36acaa">POSTGRES_PASSWORD</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">123456</span><span class="token plain"> -e </span><span class="token assign-left variable" style="color:#36acaa">POSTGRES_DB</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">rails-todo-dev -e </span><span class="token assign-left variable" style="color:#36acaa">PGDATA</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">/var/lib/postgresql/data/pgdata -v rails-todo-data:/var/lib/postgresql/data postgres:14</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="数据库常用命令">数据库常用命令<a href="#数据库常用命令" class="hash-link" aria-label="数据库常用命令的直接链接" title="数据库常用命令的直接链接">​</a></h3><ul><li><code>\c &lt;database_name&gt;</code> 连接数据库</li><li><code>\l</code> 列出全部数据库</li><li><code>\dt</code> 显示全部表格</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ide">IDE<a href="#ide" class="hash-link" aria-label="IDE的直接链接" title="IDE的直接链接">​</a></h3><ul><li>安装vscode扩展 <code>ckolkman.vscode-postgres</code></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="项目初始化">项目初始化<a href="#项目初始化" class="hash-link" aria-label="项目初始化的直接链接" title="项目初始化的直接链接">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ruby-配置">ruby 配置<a href="#ruby-配置" class="hash-link" aria-label="ruby 配置的直接链接" title="ruby 配置的直接链接">​</a></h3><ol><li><p>安装 ruby：<code>rvm install ruby-3.0.0</code></p></li><li><p>配置国内源</p></li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ gem sources --add https://gems.ruby-china.com/ --remove https://rubygems.org/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ bundle config mirror.https://rubygems.org https://gems.ruby-china.com</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="3"><li><p>安装 rails：<code>gem install rails -v 7.0.2.3</code></p></li><li><p>安装项目依赖：<code>bundle</code></p></li><li><p>数据库配置</p></li></ol><p>开发与测试数据库配置</p><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># config/database.yaml</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">development</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">&lt;&lt;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token important">*default</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">database</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> rails_todo_dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">username</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> gsemir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">password</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">123456</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">host</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> localhost</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">port</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5432</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="创建或运行项目">创建或运行项目<a href="#创建或运行项目" class="hash-link" aria-label="创建或运行项目的直接链接" title="创建或运行项目的直接链接">​</a></h3><ol><li><p>同步数据库及数据表：<code>bin/rails db:create db:migrate</code></p></li><li><p>创建项目</p></li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 仅使用api模式，指定数据库，忽略测试（后面自己配），指定项目名称</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rails new --api --database</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">postgresql --skip-test todo-backend-rails-1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="3"><li>启动 rails 项目</li></ol><p><code>bin/rails s -p 3001 -e development</code></p><p><code>bin/rails s</code> 也行</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="rspec-配置">rspec 配置<a href="#rspec-配置" class="hash-link" aria-label="rspec 配置的直接链接" title="rspec 配置的直接链接">​</a></h3><ol><li>将 <code>gem &#x27;rspec-rails&#x27;, &#x27;~&gt;5.0.0&#x27;</code> 复制到 <code>Gemfile</code> 中</li></ol><div class="language-ruby codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ruby codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">group :development, :test do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  gem &quot;debug&quot;, platforms: %i[ mri mingw x64_mingw ] </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  gem &#x27;rspec-rails&#x27;, &#x27;~&gt; 5.0.0&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="2"><li><p>运行 <code>bundle</code>，安装依赖</p></li><li><p>初始化rspec：<code>bin/rails g rspec:install</code></p></li><li><p>配置测试数据库</p></li></ol><p>在 <code>config/database.yml</code> 配置测试数据库，同开发</p><ol start="5"><li>创建数据库，同步数据表：</li></ol><p><code>RAILS_ENV=test bin/rails db:create db:migrate</code></p><ol><li>运行单元测试：</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ bundle exe rspec</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 或 rspec</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 执行指定的测试用例</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ rspec -e </span><span class="token string" style="color:#e3116c">&quot;获取当前登录用户&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 也可以指定行数</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ rspec spec/requests/api/v1/me_spec.rb:5``</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="api-文档配置">API 文档配置<a href="#api-文档配置" class="hash-link" aria-label="API 文档配置的直接链接" title="API 文档配置的直接链接">​</a></h3><ol><li>Gemfile 使用本地依赖</li></ol><div class="language-ruby codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ruby codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">gem &#x27;rspec_api_documentation&#x27;, path: &#x27;./vendor/rspec_api_documentation&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="2"><li>提前解决Api文档中请求体与响应体无法正常显示的问题</li></ol><ul><li>请求体</li></ul><div class="language-ruby codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ruby codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># spec/spec_helper.rb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">require &#x27;rspec_api_documentation&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RspecApiDocumentation.configure do |config|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # 配置文档中请求体的格式为json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  config.request_body_formatter = :json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>响应体</li></ul><p>用修复过 bug 的依赖</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 将代码克隆到 vendor 中，别忘删除掉.git</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> clone git@github.com:GSemir0418/rspec_api_documentation.git vendor/rspec_api_documentation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 刷新依赖</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ bundle</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="3"><li>创建 api 文档测试文件夹 <code>mkdir spec/acceptance</code></li></ol><hr><h1>API开发</h1><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="api-开发主要流程及命令">API 开发主要流程及命令<a href="#api-开发主要流程及命令" class="hash-link" aria-label="API 开发主要流程及命令的直接链接" title="API 开发主要流程及命令的直接链接">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="设计-tableapi">设计 table、api<a href="#设计-tableapi" class="hash-link" aria-label="设计 table、api的直接链接" title="设计 table、api的直接链接">​</a></h3><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="创建-model">创建 model<a href="#创建-model" class="hash-link" aria-label="创建 model的直接链接" title="创建 model的直接链接">​</a></h3><p><code>bin/rails g model &lt;Name&gt; field1:type field2:type</code></p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="同步数据表">同步数据表<a href="#同步数据表" class="hash-link" aria-label="同步数据表的直接链接" title="同步数据表的直接链接">​</a></h3><p><code>bin/rails db:create db:migrate</code></p><p><code>RAILS_ENV=test bin/rails db:create db:migrate</code></p><ul><li>修改表结构</li></ul><p><code>bin/rails g migrate AddDeletedAtToItems deleted_at:datetime</code></p><ul><li>回滚命令</li></ul><p><code>bin/rails db:rollback step=1</code></p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="创建-controller">创建 controller<a href="#创建-controller" class="hash-link" aria-label="创建 controller的直接链接" title="创建 controller的直接链接">​</a></h3><p><code>bin/rails g controller api/v1/&lt;controller_names&gt;</code></p><p><code>bin/rails g controller Api::V1::&lt;Names&gt;</code></p><p>驼峰和下划线都可, 斜杠也可, 在Rails中，双冒号（::）用于表示命名空间的层级关系，而斜线（/）用于表示路径的层级关系。Rails会将斜线转换为双冒号，并根据命名空间的层级关系创建相应的文件和目录结构。因此，在这两条指令中，最终生成的文件和动作都是相同的。</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="tdd">TDD<a href="#tdd" class="hash-link" aria-label="TDD的直接链接" title="TDD的直接链接">​</a></h3><ul><li>初始化</li></ul><p><code>bin/rails g rspec:install</code></p><ul><li>创建测试文件</li></ul><p><code>bin/rails g rspec:request &lt;controller_names&gt;</code></p><ul><li>创建接口测试文档文件</li></ul><p><code>touch /spec/acceptance/&lt;controller_names&gt;_spec.rb</code></p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="接口文档生成">接口文档生成<a href="#接口文档生成" class="hash-link" aria-label="接口文档生成的直接链接" title="接口文档生成的直接链接">​</a></h3><p><code>bin/rake docs:generate</code></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="设计-table">设计 Table<a href="#设计-table" class="hash-link" aria-label="设计 Table的直接链接" title="设计 Table的直接链接">​</a></h2><p>t.string 和 t.text 区别</p><ol><li><p>数据类型： t.string 创建的列会使用数据库中的字符串类型（如 VARCHAR），而 t.text 创建的列会使用数据库中的文本类型（如 TEXT）。</p></li><li><p>存储空间： 字符串类型 (t.string) 通常用于存储相对较短的文本，例如标题、姓名等，有一个固定的最大长度。而文本类型 (t.text) 通常用于存储更长的文本，如文章内容、评论等，没有固定的最大长度限制。</p></li><li><p>索引： 由于字符串类型有固定的最大长度，因此可以创建索引以提高搜索和排序的性能。文本类型没有固定的最大长度，所以不能创建普通索引，但可以创建全文索引（Full-Text Index）来支持全文搜索。</p></li></ol><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="model">Model<a href="#model" class="hash-link" aria-label="Model的直接链接" title="Model的直接链接">​</a></h2><p>执行生成命令后，rails 会帮我们创建<code>数据模型文件</code>及<code>数据库schema</code>文件；</p><p>模型类默认是单数形式的</p><p>ActiveRecord 是 Rails 中的默认 ORM 工具，用于简化与数据库的交互。</p><p>模型类通常继承 ApplicationRecord ?? ActiveRecord::Base，以实现与数据库的交互</p><p>提供验证方法 validate 支持常规校验与自定义校验，自定义校验除非在self.errors中add error，否则默认返回 nil，表示通过校验</p><p>数据范围 default_scope</p><p>声明与其他模型之间的关系 belongs_to</p><p>定义该数据模型实例的方法，例如User的generate_jwt</p><p>支持生命周期函数，例如before_create，after_create，用于数据模型实例在被创建前后执行的逻辑</p><p>总结：将数据的校验逻辑及模型相关的工具逻辑抽离到model类中</p><p>数据的校验逻辑会在执行 save/create/update 等方法时进行校验</p><p>工具逻辑（例如生成 jwt、生成验证码、发送邮件）的执行可以利用 ActiveRecord 提供的生命周期回调（<code>before_create/after_save/before_update</code> 等），决定工具函数的执行时机</p><p>而 controller 层仅用于操作数据库，根据不同情况返回不同响应</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="migration">Migration<a href="#migration" class="hash-link" aria-label="Migration的直接链接" title="Migration的直接链接">​</a></h2><p>生成 model 会生成 migration 文件</p><p>执行同步命令后，rails 会主动读取数据库信息，将数据库表结构存入 schema 文件中，因此手动更改这个文件是无效的</p><p>数据库表结构只能通过执行一次新的 migration 来修改</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="controller">Controller<a href="#controller" class="hash-link" aria-label="Controller的直接链接" title="Controller的直接链接">​</a></h2><p>执行生成命令后，rails会帮我们创建<code>控制器文件</code>及<code>对应路由</code></p><p>专注于请求/响应逻辑，与数据库交互的逻辑等</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="路由">路由<a href="#路由" class="hash-link" aria-label="路由的直接链接" title="路由的直接链接">​</a></h3><p>resource 定义了一个 RESTful 资源，表示该资源具有多个默认的 CRUD（创建、读取、更新、删除）操作。</p><p>控制器文件默认都是<strong>复数形式</strong>的，与我们在路由文件中定义的 resource 的单复数形式无关</p><ul><li><p>关于路由用 resource 还是 resources：</p><ul><li>resource用于当您只有一个模型对象（单数资源）时，例如/profile表示当前登录用户的个人资料。使用resource时，不会创建index路由，而且没有一个路由需要在URL中传递ID参数。</li><li>resources用于当您有多个模型对象（复数资源）时，例如/posts表示所有的文章。使用resources时，会创建index, show, new, edit, create, update, destroy等常用的路由，每个路由都需要在URL中传递ID参数来指定具体的对象。</li></ul></li></ul><p>在 RESTful 设计中，资源的路由通常使用复数形式，rails 也会自动将路由映射为复数形式</p><p>路由可以通过定义资源的形式来表示，例如 <code>resources :items, only: [:create, :index, :destroy]</code></p><p>手动指定路由与控制器方法的映射关系：</p><p><code>post :validation_code, to: &#x27;validation_code#create&#x27;</code></p><p>only 数组中定义了该资源接收的请求方法，其余请求方法均会返回 404</p><p>这些请求方法分别对应 controller 中的方法</p><p>其中 index 与 show 方法非常相似，但 index 用于显示资源的集合（列表），可以显示多个资源；而 show 用于显示单个资源的详细信息，主要用于显示单个资源。</p><p>这些方法通常与路由一起使用，以便在浏览器中使用相应的 URL 访问它们。例如，index方法可以与 GET /posts 或 /posts?page=1 路由关联，而show方法可以与 GET /posts/:id 路由关联</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="crud-api">CRUD Api<a href="#crud-api" class="hash-link" aria-label="CRUD Api的直接链接" title="CRUD Api的直接链接">​</a></h3><p>在编写 controller 逻辑时，通常需要借助 model 类对数据库进行增删改查的操作。下面列举一些常见 api</p><p>new 创建一个数据实例</p><p>save 将实例保存至数据库</p><p>create 相当于 new + save</p><p>find 使用主键查询</p><p>find_by 使用传入的值作为查询条件，返回第一个满足条件的数据</p><p>update 一般使用find查数据，该数据，再save，相当于update</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="响应">响应<a href="#响应" class="hash-link" aria-label="响应的直接链接" title="响应的直接链接">​</a></h3><p>rails 提供了 render、head、redirect_to等关键字指定响应体内容或重定向操作</p><p>render 关键字可以指定要渲染的视图模板、设置响应头、指定响应格式等</p><ul><li><code>render json: {}</code>：将指定的 JSON 对象作为响应的主体。</li><li><code>render plain: &#x27;text&#x27;</code>：将指定的纯文本作为响应的主体。</li><li><code>render file: &#x27;path/to/file&#x27;</code>：将指定的文件内容作为响应的主体。</li><li><code>render template: &#x27;path/to/template&#x27;</code>：渲染指定的视图模板并作为响应的主体。</li><li><code>render action: :new</code>：渲染指定动作对应的视图模板并作为响应的主体。</li></ul><p><code>head</code> 方法则更适用于简单的状态码响应，不需要具体响应主体内容的情况。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="tdd-1">TDD<a href="#tdd-1" class="hash-link" aria-label="TDD的直接链接" title="TDD的直接链接">​</a></h2><p>TDD 测试驱动开发是一种开发策略，即先写单元测试，再以通过测试的目的来写 controller 层逻辑。测试完成后，接口功能基本也实现了</p><p>测试分成单元测试和文档测试，单元测试用来测试接口失败的情况，而文档测试用来测试接口成功的情况，成功后会自动生成接口文档</p><p>配置rspec，统一文档测试时的请求头</p><div class="language-ruby codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ruby codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># spec/spec_helper.rb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Rspec.configure do |config|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  config.before(:each) do |spec|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 如果是acceptance类型的测试</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if spec.metadata[:type].equal? :acceptance</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      header &#x27;Accept&#x27;, &#x27;application/json&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      header &#x27;Content-Type&#x27;, &#x27;application/json&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>生成文档命令：<code>bin/rake docs:generate</code></p><ul><li><p>bin/rake 与 bin/rails 的区别：</p><ul><li><p>bin/rake 用于执行 Rake 任务，比如数据库迁移、测试运行、api文档生成等</p></li><li><p>bin/rails 提供了更高级的命令，比如服务器运行、应用程序生成等</p></li></ul></li></ul><p>接口文档页面在 doc/api 文件夹下，使用 <code>npx http-server doc/api</code> 来查看</p><h1>其他</h1><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="密钥管理">密钥管理<a href="#密钥管理" class="hash-link" aria-label="密钥管理的直接链接" title="密钥管理的直接链接">​</a></h2><ol><li>生成或编辑 keys <code>bin/rails credentials:edit</code></li><li>or 指定 vscode 编辑 <code>EDITOR=&quot;code --wait&quot; bin/rails credentials:edit</code></li><li>读取 keys <code>bin/rails c | Rails.application.credentials.secret_key_base</code> 或者 <code>Rails.application.credentials.config</code></li><li>生产环境 keys <code>EDITOR=&quot;code --wait&quot; rails credentials:edit --environment production</code></li><li>需要自定义 secret_key_base</li><li>读取生产环境 keys <code>RAILS_ENV=production bin/rails c | Rails.application.credentials.secret_key_base</code> 或者 <code>Rails.application.credentials.config</code></li><li>生产环境数据库配置</li><li>剧透：对于本项目来说，只会管理 jwt 密钥、邮箱服务器授权码及数据库密码</li><li>查看密钥：<code>bin/rails c | Rails.application.credentials.config</code></li></ol><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="中间件">中间件<a href="#中间件" class="hash-link" aria-label="中间件的直接链接" title="中间件的直接链接">​</a></h2><p>写中间件
bin/rails middleware 显示全部中间件
touch lib/auto_jwt.rb 在lib下创建中间件文件（lib是自己给自己写的库，vendor是别人给自己写的库）</p><p>全局配置中间件</p><div class="language-rb codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rb codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># config/application.rb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">require_relative &quot;../lib/auto_jwt&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Bundler.require(*Rails.groups)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module RailsTodo1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  class Application &lt; Rails::Application</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    config.middleware.use AutoJwt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>改写 mes controller</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="配置邮件服务器">配置邮件服务器<a href="#配置邮件服务器" class="hash-link" aria-label="配置邮件服务器的直接链接" title="配置邮件服务器的直接链接">​</a></h2><ol><li>创建 mailer <code>bin/rails generate mailer User</code></li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">create  app/mailers/user_mailer.rb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">invoke  erb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">create    app/views/user_mailer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">invoke  rspec</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">create    spec/mailers/user_spec.rb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">create    spec/mailers/previews/user_preview.rb</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="2"><li>Mailer 全局配置</li></ol><div class="language-rb codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rb codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># app/mailers/application_mailer.rb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class ApplicationMailer &lt; ActionMailer::Base</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 全局发送邮件地址</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  default from: &quot;845217811@qq.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # html默认布局</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  layout &#x27;mailer&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="3"><li>邮件配置</li></ol><div class="language-rb codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rb codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># app/mailers/user_mailer.rb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class UserMailer &lt; ApplicationMailer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  def welcome_email(code)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 给模板传递变量</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @code = code</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mail(to: &quot;845217811@qq.com&quot;, subject: &#x27;Welcome to My Awesome Site&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="4"><li>修改邮件内容</li></ol><div class="language-erb codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-erb codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;!-- app/views/user_mailer/welcome_email.html.erb --&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;!DOCTYPE html&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;html&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;head&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;meta content=&quot;text/html; charset=UTF-8&quot; http-equiv=&quot;Content-Type&quot; /&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;/head&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;body&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;%# 使用传递的变量 %&gt; hi &lt;%= @code %&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;/body&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/html&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="5"><li>开启 qq 邮箱的 smtp 服务：登录 qq 邮箱，点击「设置」=&gt;「账户」=&gt;「开启 IMAP/SMTP 服务」=&gt;「短信验证」</li><li>保存授权码：<code>EDITOR=&quot;code --wait&quot; bin/rails credentials:edit</code></li><li>写入 email_pw: ycmbmysnijqcbfgb</li><li>配置邮件服务：记得生产环境也要配置</li></ol><div class="language-ruby codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ruby codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># config/environments/development.rb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 是否抛出邮件错误</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">config.action_mailer.raise_delivery_errors = true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 是否使用缓存</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">config.action_mailer.perform_caching = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">config.action_mailer.smtp_settings = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  address:              &#x27;smtp.qq.com&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  port:                 587,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  domain:               &#x27;smtp.qq.com&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  user_name:            &#x27;845217811@qq.com&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  password:             Rails.application.credentials.email_pw,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  authentication:       &#x27;plain&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  anable_starttls_auto: true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  open_timeout:         10,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  read_timeout:         10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="10"><li>控制台测试邮件发送功能
<code>bin/rails console</code></li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 使用UserMailer内置方法即可</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">UserMailer.welcome_email(&#x27;123456&#x27;).deliver</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>记得生产环境也需要配置授权码</p><h1>部署</h1></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>标签：</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog-docusaurus-preview/docs/tags/ruby">ruby</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog-docusaurus-preview/docs/tags/ruby-on-rails">ruby on rails</a></li></ul></div></div><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/GSemir0418/blog-docusaurus/tree/master/docs/Ruby/Rails项目总结.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog-docusaurus-preview/docs/category/ruby"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">Ruby</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog-docusaurus-preview/docs/category/tutorial---extras"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">Tutorial - Extras</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#环境配置" class="table-of-contents__link toc-highlight">环境配置</a><ul><li><a href="#macos" class="table-of-contents__link toc-highlight">macos</a></li><li><a href="#ubuntuwsl" class="table-of-contents__link toc-highlight">ubuntu(wsl)</a></li></ul></li><li><a href="#数据库配置" class="table-of-contents__link toc-highlight">数据库配置</a><ul><li><a href="#macos-1" class="table-of-contents__link toc-highlight">macos</a></li><li><a href="#ubuntuwsl-1" class="table-of-contents__link toc-highlight">ubuntu(wsl)</a></li><li><a href="#docker" class="table-of-contents__link toc-highlight">docker</a></li><li><a href="#数据库常用命令" class="table-of-contents__link toc-highlight">数据库常用命令</a></li><li><a href="#ide" class="table-of-contents__link toc-highlight">IDE</a></li></ul></li><li><a href="#项目初始化" class="table-of-contents__link toc-highlight">项目初始化</a><ul><li><a href="#ruby-配置" class="table-of-contents__link toc-highlight">ruby 配置</a></li><li><a href="#创建或运行项目" class="table-of-contents__link toc-highlight">创建或运行项目</a></li><li><a href="#rspec-配置" class="table-of-contents__link toc-highlight">rspec 配置</a></li><li><a href="#api-文档配置" class="table-of-contents__link toc-highlight">API 文档配置</a></li></ul></li><li><a href="#api-开发主要流程及命令" class="table-of-contents__link toc-highlight">API 开发主要流程及命令</a><ul><li><a href="#设计-tableapi" class="table-of-contents__link toc-highlight">设计 table、api</a></li><li><a href="#创建-model" class="table-of-contents__link toc-highlight">创建 model</a></li><li><a href="#同步数据表" class="table-of-contents__link toc-highlight">同步数据表</a></li><li><a href="#创建-controller" class="table-of-contents__link toc-highlight">创建 controller</a></li><li><a href="#tdd" class="table-of-contents__link toc-highlight">TDD</a></li><li><a href="#接口文档生成" class="table-of-contents__link toc-highlight">接口文档生成</a></li></ul></li><li><a href="#设计-table" class="table-of-contents__link toc-highlight">设计 Table</a></li><li><a href="#model" class="table-of-contents__link toc-highlight">Model</a></li><li><a href="#migration" class="table-of-contents__link toc-highlight">Migration</a></li><li><a href="#controller" class="table-of-contents__link toc-highlight">Controller</a><ul><li><a href="#路由" class="table-of-contents__link toc-highlight">路由</a></li><li><a href="#crud-api" class="table-of-contents__link toc-highlight">CRUD Api</a></li><li><a href="#响应" class="table-of-contents__link toc-highlight">响应</a></li></ul></li><li><a href="#tdd-1" class="table-of-contents__link toc-highlight">TDD</a></li><li><a href="#密钥管理" class="table-of-contents__link toc-highlight">密钥管理</a></li><li><a href="#中间件" class="table-of-contents__link toc-highlight">中间件</a></li><li><a href="#配置邮件服务器" class="table-of-contents__link toc-highlight">配置邮件服务器</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">博客</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://gsemir0418.github.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">旧博客<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">社交媒体</div><ul class="footer__items clean-list"><li class="footer__item"><a href="mailto:gsemir0418@gmail.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Gmail<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/GSemir0418" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog-docusaurus-preview/docs/intro">Blog</a></li><li class="footer__item"><a href="https://github.com/GSemir0418" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 GSemir Built with Docusaurus.</div></div></div></footer></div>
<script src="/blog-docusaurus-preview/assets/js/runtime~main.4b3a6e80.js"></script>
<script src="/blog-docusaurus-preview/assets/js/main.ce3b1955.js"></script>
</body>
</html>